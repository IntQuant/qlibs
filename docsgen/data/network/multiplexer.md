## The guide to multiplexer

### Overview

This module implements lockstep based multiplayer.
There are two main classes: MultiplexServer and MultiplexClient, in addition to several event classes.

### MultiplexServer

Server listens to client sockets, accepts connections and sends/recieves events from clients. It does not need to be configured, except giving it a port and optionally **engine_packer**.

Use `server_forever()` or `serve_in_thread()` to start it. Calling `stop_thread()` will stop it.

### MultiplexClient

Requires engine instance to be initialized plus optional **host** and **port**.
Optional **engine_constructor** is required for engine reconstruction.

It's field **min_step_time** is *obviusly* responsible for minimal time between steps.

Engine class should have `step()` method, accepting dt and list of events:
```python
#Example engine class
class Engine:
    def step(self, dt, events):
        print(f"{dt} seconds elapsed from last step")
        for event in events:
            if event.name == "playerjoined":
                print(f"Played {event.player_id} joined")
            elif event.name == "playerleft":
                print(f"Player {event.player_id} left")
            elif event.name == "payload":
                print(f"Recieved data {event.data}")
```
`send_payload(data: bytes)` will create PayloadEvent with given data.

It can be run by using `run_in_thread()`. Calling `stop_thread()` will stop it.
Alternatively `step()` can be used in your mainloop.

### Events

There are several types of events (their name field is given in brackets):
- PlayerJoinedEvent ("playerjoined")
- PlayerLeftEvent ("playerleft")
- PayloadEvent ("payload")
- In addition to several non-public ones.

All of them have **player_id** field which represents the player it belongs to(either the one who sent it or caused it)
PayloadEvent also has **data** field, containing the data it was created with.

First two event types are generated automatically generated by server. PayloadEvent is generated by client using `send_payload(data)` call.



